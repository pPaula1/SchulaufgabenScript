{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "exam.schema.json",
  "title": "Exam (minimal, no redundancy)",
  "type": "object",
  "additionalProperties": false,

  "required": ["id", "school_id", "title", "subject", "class", "date", "tasks"],

  "properties": {
	"$schema": { "type": "string" },
	  
    "id": {
      "type": "string",
      "pattern": "^[a-z0-9][a-z0-9_\\-]{2,64}$"
    },

    "school_id": {
      "type": "string",
      "pattern": "^[a-z0-9][a-z0-9_\\-]{2,64}$",
      "description": "References schools/<school_id>.json"
    },

    "title": { "type": "string", "minLength": 1 },
    "subject": { "type": "string", "minLength": 1 },

    "class": {
      "type": "string",
      "minLength": 1,
      "description": "e.g. 9b"
    },

    "date": {
      "type": "string",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
      "description": "YYYY-MM-DD"
    },

    "tasks": {
      "type": "array",
      "minItems": 1,
      "items": { "$ref": "#/$defs/taskRef" }
    },

    "version": { "type": "string", "default": "1.0" }
  },

  "$defs": {
    "taskRef": {
      "type": "object",
      "additionalProperties": false,
      "required": ["id"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^[a-z0-9][a-z0-9_\\-]{2,64}$",
          "description": "Task id (matches tasks/<id>/task.json)."
        },

        "points_override": {
          "type": "number",
          "minimum": 0,
          "description": "Optional override (rare). Usually points come from task.json."
        },

        "page_break_before": {
          "type": "boolean",
          "description": "Optional page break before this task."
        }
      }
    }
  }
}